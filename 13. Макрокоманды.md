На основе представленной презентации, **макрокоманда** — это символическое имя, которое при трансляции замещается заранее описанной последовательностью строк кода. Этот процесс называется **макрогенерацией**, а итоговый подставленный код — **макрорасширением**.

### 1. Определение макрокоманды (Макроопределение)

Чтобы использовать макрокоманду, сначала нужно создать её шаблон.

- **Синтаксис:**
    
    Фрагмент кода
    
    ```
    имя_макрокоманды MACRO [список_формальных_аргументов]
        ; тело макроопределения
    ENDM
    ```
    
- **Аргументы:** В теле макроса используются _формальные аргументы_, которые при вызове заменяются на _фактические_.
    

---

### 2. Применение (Вызов)

Для вызова достаточно написать имя макрокоманды и передать ей параметры:

<имя_макрокоманды> <фактические_аргументы>

В отличие от процедур, макрокоманда **не генерирует вызов (CALL)**. Транслятор просто копирует содержимое макроса прямо в то место программы, где встретилось его имя.

---

### 3. Директива LOCAL

Если внутри макроса используются метки, при повторном вызове макрокоманды возникнет ошибка «дублирование имен». Для решения этой проблемы используется директива `LOCAL`.

- **Синтаксис:** `LOCAL <список_идентификаторов>`
    
- **Как работает:** Ассемблер заменяет имя метки на уникальный идентификатор вида `??xxxx` (например, `??0001`), что позволяет использовать один и тот же макрос многократно в одной программе.
    

---

### 4. Сравнение макрокоманд и процедур

|**Характеристика**|**Макрокоманда**|**Процедура**|
|---|---|---|
|**Принцип работы**|Подстановка текста (копирование кода).|Передача управления (CALL/RET).|
|**Объем программы**|Увеличивается при каждом вызове.|Код компактнее (описан один раз).|
|**Скорость**|Выше (нет затрат на переходы и стек).|Ниже (затраты на вызов и возврат).|
|**Гибкость**|Высокая (можно менять сами команды через аргументы).|Низкая (текст команд неизменен).|

---

### 5. Пример макрокоманды

Макрос для вывода символа на экран (используя прерывание):

Фрагмент кода

```
put_char macro char
    mov ah, 02h      ; функция вывода символа
    mov dl, char     ; аргумент подставляется сюда
    int 21h          ; вызов прерывания
endm

; Использование:
put_char 'A'         ; В код вставится 3 строки с 'A'
put_char bl          ; В код вставится те же 3 строки с регистром bl
```

**Главное достоинство макросов** — улучшение читаемости кода без потери производительности, так как они позволяют «спрятать» часто повторяющиеся системные вызовы за короткими именами.

Хотите рассмотреть более сложный макрос, который использует условную макрогенерацию (директивы `IF`, `ELSE`)?